COMPONENT frontend service
ROUTE -m GET *

FROM node:alpine as build
ENV NODE_ENV production

COPY package*.json  ./
RUN npm --production=false install
COPY webpack*.js ./
COPY /public ./public
COPY /src ./src

RUN if [ "$NODE_ENV" = "production" ] ; then npm run build ; else npm run dev ; fi

FROM nginx:alpine
COPY --from=build /dist /usr/share/nginx/html
ENTRYPOINT ["nginx", "-g", "daemon off;"]
